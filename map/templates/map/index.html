{% load static %}

<!DOCTYPE html>
<html lang="en">
  <head>
      <title>Map</title>
      <script src='https://api.mapbox.com/mapbox-gl-js/v1.11.1/mapbox-gl.js'></script>
      <link href='https://api.mapbox.com/mapbox-gl-js/v1.11.1/mapbox-gl.css' rel='stylesheet' />
      <link rel="stylesheet" type="text/css" href="{% static 'map/style.css' %}">
      <script>
          function center() { //doesnt work; page refreshes when pin is set -->
              country = {{country}}
              //map.center = [69.190028, 34.534618];-->
              //set to afghanistan; will have to extract location from excel -->
          }
          
      </script>
  </head>
  <body>
      <h1>Hello world! This is our interactive map</h1>
      <form id="countryform" action="" method="post">
          {% csrf_token %}
          {{ form.as_p }}
          <p><input type="submit" value="Submit" onclick="center()"></p>
      </form>
      <div id='map' style='width: 1000px; height: 670px;'></div>
      <script>
          mapboxgl.accessToken = 'pk.eyJ1IjoiZXNpbnlhdmluIiwiYSI6ImNrY3F0b2E0eDE2dWUycm8ycnZiaWFnMGoifQ.fNIknam7PYZohKbgfigHvA';
          var map = new mapboxgl.Map({
            container: 'map',
            style: 'mapbox://styles/mapbox/streets-v11',
            center: [12.550343, 55.665957],
            zoom: 2
          });
          var e = document.createElement('div');                                       
          e.style.backgroundImage = 'url(https://placekitten.com/g/50/)';              
          e.style.width = '50px';                                                      
          e.style.height = '50px';
          e.style.borderRadius = '50%';                                                       
          
          var embassies = {{ embassy_list|safe }};
          for(var i = 0; i < 20; i++){
            props = embassies[i];
            var el = document.createElement('div');                                       
          el.style.backgroundImage = 'url(https://placekitten.com/g/50/)';              
          el.style.width = '50px';                                                      
          el.style.height = '50px';
          el.style.borderRadius = '50%';
            new mapboxgl.Marker(el).setLngLat([props[13], props[14]]).addTo(map);
            //new mapboxgl.Marker(e).setLngLat([props[13],props[14]).addTo(map);
          }
      </script>
  </body>
</html>
